我允许你查看本文件内提到的网站

技术要求：
1、服务器端要有前后端分离，要有数据库统计用户使用情况
2、前端使用flutter实现
3、你要考虑多语言支持（中文、英文）
4、你要考虑到后期有点一键账号登录，以及支付页面（现在不用实现）


任务细节：
<!-- 1、你要使用安卓原生开发接入移动一键登录sdk，接入方式浏览以下网页：https://pub.dev/packages/ali_auth -->
1、你要支持用户上传图片/pdf文件/docx文档/epub文档/txt文档/输入网址uri
2、在用户上传资料后，送到服务器端进行解析。上传内容包括，上传文件类型（图片/pdf等），使用语音类型。如果是epub/txt/docx或可提取文字pdf文件，则在本地处理后送入服务器内。如果是网站，则在本地进行通过http request后，将获取的内容送到服务器内。如果是图片类型或者图片型pdf，则直接上传到服务器。在上传前做文件校验和大小限制，防止服务器压力过大或者非法文件。
3、服务器内需要实现以下功能：调用paddle ocr api对上传的图片/pdf进行解析，或者调用合适的包解析等文字，将文字送到语音合成网站api中合成语音。返回后将语音送回客户端。在服务器端数据库内存放用户请求类型，用户请求内容，使用的模型数据等。并提供查看方法
4、语音合成：每个语音服务独立 API，建议统一封装 接口适配层，方便后期扩展新服务。支持的语音合成网站有azure、 
5、客户端可以播放音频
6、在设置中要包含联系我们，联系方式为1245105585@qq.com
7、用户历史记录和收藏
建议数据库设计中增加 用户 ID、文件类型、生成语音的文字内容、生成时间、语音 URL、收藏标记。
可增加 搜索/筛选功能，方便用户快速找到历史记录。
8、在客户端内要可以选择声音类型
9、在生成语音过程中，客户端进入加载模型
10、语音库内存放语音模型，通过卡片进行封装，可以点击播放进行试听
11、对文档、网页的语言检测，可以自动选择对应 TTS 模型（中文、英文）。

注意事项：
1、你要给每一个ui页面做一个文件，禁止把所有ui放到同一个文件。
2、所有api调用密钥统一在文件中进行管理
3、所有页面切换必须添加ui动画，保证操作顺滑
4、你要**适配状态栏**
5、你要**认真分析参考图布局**生成的**ui要高度接近参考图，不得随意编造修改**，参考图存放在referPhoto文件夹内
6、你要**支持深色模式和浅色模式**
7、仅在使用时申请对应权限
8、你要有隐私协议和用户协议

其他信息：
1、服务器的域名为internjob.top，使用端口为1999
2、参考referPhoto中的
3、你需要实现服务器端和本地端的代码
4、一些flutter库参考代码目录：液态玻璃组件：https://pub.dev/packages/liquid_glass_renderer
card class
alipay：https://pub.dev/packages/alipay_kit_new
audioplayer：https://pub.dev/packages/audioplayers
<!-- alia-uth :https://pub.dev/packages/ali_auth -->

以下是代码框架
好的，我帮你把你之前提供的需求整理成一套 **完整项目方案**，包括客户端 Flutter 架构、后端架构、数据库设计、文件/任务流程、OCR/TTS 流程、权限及多语言管理等。方案将以 **模块化、可扩展、可落地开发** 为原则。

---

# **一、项目整体架构**

```
Flutter Client
├─ UI Pages (每页单独文件)
│  ├─ HomePage.dart
│  ├─ UploadPage.dart
│  ├─ HistoryPage.dart
│  ├─ AudioPlayerPage.dart
│  ├─ SettingsPage.dart
│  └─ ContactPage.dart
├─ Widgets
│  ├─ LiquidGlassCard.dart
│  ├─ FileItemWidget.dart
│  └─ AudioCardWidget.dart
├─ State Management
│  └─ Riverpod/Provider
├─ Services
│  ├─ ApiService.dart  (所有接口调用)
│  ├─ AudioService.dart
│  ├─ FileService.dart
│  └─ LanguageService.dart
├─ Localization
│  ├─ en.json
│  └─ zh.json
├─ Animations
  └─ PageTransition.dart

```

---

```
Backend Server (internjob.top:1999)
├─ Framework: Node.js Express 
├─ Modules
└─ Config
│  └─ ApiKeys
│  ├─ FileUploadModule
│  │   └─ 接收图片/pdf/docx/epub/txt/URL
│  ├─ OCRModule
│  │   └─ 调用 PaddleOCR API 或本地 OCR
│  ├─ TextParsingModule
│  │   └─ 解析文本型 PDF / DOCX / TXT / EPUB / HTML
│  ├─ TTSModule
│  │   ├─ AzureTTS.dart
│  │   ├─ GoogleTTS.dart
│  │   └─ 其他语音服务封装
│  ├─ UserModule
│  │   ├─ 用户管理
│  │   └─ 使用记录统计
│  ├─ HistoryModule
│  │   └─ 存储历史生成记录（数据库）
│  └─ AnalyticsModule
│      └─ 用户请求统计
├─ Database: MySQL
│  ├─ users
│  ├─ files
│  ├─ history
│  └─ usage_stats
└─ Storage
   ├─ 临时文件目录 /tmp
   ├─ 永久语音存储（可用 CDN）
   └─ 安全访问控制
```

---

# **二、数据库设计（示例）**

### 1. users 表

| 字段         | 类型        | 说明             |
| ---------- | --------- | -------------- |
| id         | bigint    | 用户唯一ID         |
| username   | varchar   | 用户名 / 手机号 / 邮箱 |
| created_at | timestamp | 注册时间           |
| language   | varchar   | 用户偏好语言（zh/en）  |

### 2. files 表

| 字段            | 类型        | 说明                               |
| ------------- | --------- | -------------------------------- |
| id            | bigint    | 文件ID                             |
| user_id       | bigint    | 上传用户                             |
| type          | varchar   | 文件类型：image/pdf/docx/epub/txt/url |
| original_name | varchar   | 原文件名/网址                          |
| size          | bigint    | 文件大小                             |
| upload_time   | timestamp | 上传时间                             |
| status        | varchar   | pending/processing/done/failed   |
| result_text   | text      | 解析出的文字                           |

### 3. history 表

| 字段          | 类型        | 说明      |
| ----------- | --------- | ------- |
| id          | bigint    | 历史记录ID  |
| user_id     | bigint    | 用户ID    |
| file_id     | bigint    | 文件ID    |
| voice_type  | varchar   | 选择的语音类型 |
| audio_url   | varchar   | 生成语音URL |
| created_at  | timestamp | 生成时间    |
| is_favorite | bool      | 收藏标记    |

### 4. usage_stats 表

| 字段           | 类型        | 说明             |
| ------------ | --------- | -------------- |
| id           | bigint    | 统计ID           |
| user_id      | bigint    | 用户ID           |
| request_type | varchar   | 文件解析/语音生成/网页抓取 |
| timestamp    | timestamp | 请求时间           |
| success      | bool      | 是否成功           |

---

# **三、文件 & 任务处理流程**

1. **客户端上传**

   * 文本型 PDF / DOCX / TXT / EPUB → **本地解析后发送文本**
   * 图片 / 图片型 PDF → **直接上传到服务器**
   * URL → 本地请求 HTML → 解析文字 → 发送给服务器

2. **服务器端处理**

   * 异步任务队列处理 OCR 或 TTS（Celery/Redis / RabbitMQ）
   * OCR 或文本解析 → 获取纯文字 → 送到 TTS 模块
   * TTS → 生成音频文件 → 存储 → 返回音频 URL 给客户端

3. **客户端播放**

   * 历史记录通过液态玻璃卡片显示，可点击播放、收藏、删除
   * 支持播放、暂停、试听、下载缓存

---

# **四、Flutter 客户端关键点**

1. **多语言支持**

   * 使用 `intl` + `en.json` / `zh.json`
   * 所有 UI、提示、按钮文本都支持切换语言
2. **状态管理**

   * Riverpod/Provider 管理用户信息、上传状态、音频播放状态、历史记录状态
3. **UI 设计**

   * 页面动画切换（`PageRouteBuilder` + fade/slide）
   * 深色/浅色模式自动切换
   * 状态栏适配（`AnnotatedRegion<SystemUiOverlayStyle>`）
   * 液态玻璃卡片封装通用 widget
4. **权限管理**

   * 文件读写、存储权限按需申请（`permission_handler`）
5. **音频播放**

   * `audioplayers` 播放网络音频 + 本地缓存
6. **配置管理**

   * 所有 API Key、TTS 服务密钥统一在 `Config/ApiKeys.dart`
7. **设置页面**

   * 联系我们：[1245105585@qq.com](mailto:1245105585@qq.com)
   * 隐私协议 & 用户协议
   * 语言切换

---

# **五、后端 TTS & OCR 模块设计**

```
OCRModule
├─ PaddleOCRClient.dart
├─ LocalOCR.dart (可选)
└─ OCRService
    ├─ detectLanguage(file)
    └─ extractText(file)

TTSModule
├─ AzureTTSClient.dart
├─ GoogleTTSClient.dart
├─ OtherTTSClient.dart
└─ TTSService
    ├─ generateAudio(text, voiceType)
    └─ cacheAudio(text, voiceType)
```

> 每个 TTS 服务封装成单独文件，接口统一，便于后续扩展。

---

# **六、补充考虑点**

1. **安全**

   * 文件和音频 URL 访问权限控制
   * API Token 校验
   * HTTPS / SSL

2. **性能**

   * 异步任务队列（OCR/TTS）
   * 音频缓存
   * 文件大小限制

3. **可扩展**

   * 后续支持一键登录、支付、订阅功能
   * 多语言 TTS
   * 扩展新的文件类型或网站爬取逻辑

4. **用户体验**

   * 进度加载动画
   * 错误提示与重试
   * 历史记录可收藏、删除
   * 深色模式 & 流畅动画

---

# **七、技术栈总结**

| 层    | 技术选择                                                             |
| ---- | ---------------------------------------------------------------- |
| 客户端  | Flutter + Riverpod + intl + audioplayers + liquid_glass_renderer |
| 后端   | Node.js (Express) +  Node Queue      |
| 数据库  |  MySQL                                               |
| 文件存储 | 本地                                                     |
| OCR  | PaddleOCR API / 本地 OCR                                           |
| TTS  | Azure TTS / Google TTS / 其他                                      |
| 云服务  | 端口 1999                                             |




